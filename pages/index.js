import Head from "next/head";
import styles from "@/styles/Home.module.css";
import gStyles from "../styles/global.module.css";
import { getData } from "@/firebase/db/getData";
import { useRef, useEffect, useState } from "react";
import { addData } from "@/firebase/db/addData";
import { useRouter } from "next/router";
import Image from "next/image";
import bannerImageDesktop from "../public/images/home/banner-picture-desktop.svg";
import bannerImageMobile from "../public/images/home/banner-picture-mobile.svg";
import SearchBarGeo from "@/components/search/SearchBarGeo";
import SearchBarMobile from "@/components/search/SearchBarMobile";
import NavOptions from "@/components/home/NavOptions";
import LandingPagePagination from "@/components/home/LandingPagePagination";
import { dealsOfWeek, news, trips } from "@/helper/db/staticData";
import DealsCard from "@/components/home/cards/DealsCard";
import { IconButton } from "@mui/material";
import NewsCard from "@/components/home/cards/NewsCard";
import AdsBanner from "@/components/home/AdsBanner";
import GuideBookSection from "@/components/home/GuideBookSection";
import TripsCard from "@/components/home/cards/TripsCard";
import DealsComponentMobile from "@/components/home/mobile/DealsComponentMobile";
import DealsComponentDesktop from "@/components/home/desktop/DealsComponentDesktop";
import ChevronRightIcon from "@mui/icons-material/ChevronRight";

export default function Home() {
	const [lastScrollY, setLastScrollY] = useState(0);
	const [lastScrollYMobile, setLastScrollYMobile] = useState(0);
	const offersRef = useRef();
	const offersMobileRef = useRef();

	// useEffect(() => {
	// 	if (typeof window !== "undefined") {
	// 		if (offersRef !== "undefined") {
	// 			const offersYPosition = offersRef.current.offsetTop;
	// 			const offersYPositionMobile = offersMobileRef.current.offsetTop;
	// 			localStorage.setItem("offersYPosition", offersYPosition);
	// 			localStorage.setItem("offersYPositionMobile", offersYPositionMobile);
	// 		}
	// 	}
	// }, [lastScrollY, lastScrollYMobile]);

	// useEffect(() => {
	// 	detectScroll();
	// }, [lastScrollY, lastScrollYMobile]);

	function detectScroll() {
		if (typeof window !== "undefined") {
			window.addEventListener("scroll", controlNavbar);
		} else {
			return () => {
				window.removeEventListener("scroll", controlNavbar);
			};
		}
	}

	function controlNavbar() {
		if (typeof window !== "undefined") {
			const scrollPosition = window.scrollY;

			setLastScrollY(scrollPosition);
			setLastScrollYMobile(scrollPosition);
		}
	}

	function offersSectionDesktop(offersRef) {
		return <DealsComponentDesktop offersRef={offersRef} />;
	}

	function offersSectionMobile(offersMobileRef) {
		const titles = [
			"Deals of the week",
			"Job available",
			"Room for rent",
			"Staff pick item",
		];
		return (
			<div ref={offersMobileRef}>
				{titles.map((title, idx) => (
					<DealsComponentMobile key={idx} title={title} />
				))}
			</div>
		);
	}

	return (
		<>
			<Head>
				<title>Thai Now</title>
				<meta name="description" content="Generated by create next app" />
				<meta name="viewport" content="width=device-width, initial-scale=1" />
				<link rel="icon" href="/images/logos/logo_white.svg" />
			</Head>
			<main className={styles.main}>
				<section className={`${styles.banner_section}`}>
					{/* <Image
						src={bannerImageMobile}
						alt="banner image"
						className={`${styles.banner_image_mobile}`}
						priority={true}
					/> */}

					{/* <Image
						src={bannerImageDesktop}
						alt="banner image"
						className={`${styles.banner_image_desktop}`}
						priority={true}
					/> */}

					{/* <SearchBarGeo /> */}
					{/* <SearchBarMobile /> */}
				</section>
				{/* <section className={`${styles.navigation_options_section}`}>
					<div className={`${styles.navgation_options_container}`}>
						<h3>Feast Like Never Before</h3>
						<p className={`${gStyles.p_small}`}>
							Learn More{" "}
							<br className={`${styles.navigation_subheading_break}`} /> About
							Our Revolutionary Packages
						</p>
						<NavOptions source="home" />
					</div>
				</section> */}
				{/* <section className={`${styles.offers_section}`}>
					{offersSectionMobile(offersMobileRef)}
					{offersSectionDesktop(offersRef)}
				</section> */}
				{/* <section className={`${styles.news_section}`}>
					<div className={`${styles.flexRow} ${styles.news_header}`}>
						<h3>Hot News</h3>
						<LandingPagePagination />
						<div className={`${styles.right_arrow_button}`}>
							<IconButton>
								<ChevronRightIcon fontSize="large" />
							</IconButton>
						</div>
					</div>
					<div className={`${styles.news_card_container} ${styles.flexRow}`}>
						{news.map((newsContent, idx) => {
							return <NewsCard key={idx} newsContent={newsContent} />;
						})}
					</div>
				</section> */}
				<section className={`${styles.ad_section}`}>
					<AdsBanner />
				</section>
				{/* <section className={`${styles.guide_book_section}`}>
					<div className={`${styles.flexRow} ${styles.guide_book_header}`}>
						<h3>Guide Book</h3>
						<LandingPagePagination />
						<div className={`${styles.right_arrow_button}`}>
							<IconButton>
								<ChevronRightIcon fontSize="large" />
							</IconButton>
						</div>
					</div>
					<GuideBookSection />
				</section> */}
				{/* <section className={`${styles.ad_section}`}>
					<AdsBanner />
				</section> */}
				{/* <section className={`${styles.trips_section}`}>
					<div className={`${styles.flexRow} ${styles.trips_header}`}>
						<h3>Trips</h3>
						<LandingPagePagination />
						<div className={`${styles.right_arrow_button}`}>
							<IconButton>
								<ChevronRightIcon fontSize="large" />
							</IconButton>
						</div>
					</div>
					<div className={`${styles.trips_container} ${styles.flexRow}`}>
						{trips.map((trip, idx) => {
							return <TripsCard key={idx} trip={trip} />;
						})}
					</div>
				</section> */}
			</main>
		</>
	);
}

// export async function getServerSideProps(context) {
// 	const data = await getData();
// 	const dataObject = JSON.parse(JSON.stringify(data));

// 	console.log("SSR data:", dataObject);

// 	return {
// 		props: { dataObject },
// 	};
// }
